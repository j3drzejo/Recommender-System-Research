# 🎥 Video Recommendation System

**A Comparative Analysis of Three Algorithms for Short-Form Content**

## 📌 Overview

This project explores the effectiveness of three distinct recommendation algorithms for **short-form video content**, comparing:

- 🔹 **Two-Tower Neural Network**
- 🔹 **Hybrid Collaborative + Content-Based Filtering**
- 🔹 **Multi-Armed Bandit (Epsilon-Greedy Strategy)**

Alongside the recommender system, an **AI-powered content generation pipeline** was developed to simulate realistic video content. The system was tested through live user studies to evaluate user engagement, content quality, and algorithmic performance.

## 👨‍🔬 Authors

- **Jedrzej Irla**
- **Wienczyslaw Wlodyga**

## ⚙️ Tech Stack

| Component      | Technology            |
| -------------- | --------------------- |
| Backend        | Python, FastAPI       |
| Frontend       | React (Vite)          |
| Database       | SQLite                |
| ML/IR          | Scikit-learn (TF-IDF) |
| TTS            | Google Text-to-Speech |
| AI Content Gen | Ollama’s Gemma 3:4b   |

## 🧠 Algorithms Explained

### 1. Two-Tower Neural Network

This model creates two separate embedding towers—one for users and one for videos. It uses TF-IDF vectorization to encode video content and user preferences based on interaction history. User embeddings are generated by weighting watched videos according to engagement level (e.g., watch time, likes). The system then calculates cosine similarity between user and video embeddings to recommend top content.

### 2. Hybrid Recommender

Combines:

- **Content-Based Filtering** using textual similarity (TF-IDF) between watched and unwatched videos.
- **Collaborative Filtering** using item-item similarities from interaction data.
- Includes a random exploration component (~20%) to encourage content diversity and mitigate filter bubbles.

### 3. Multi-Armed Bandit

Implements an **epsilon-greedy strategy** (10% exploration, 90% exploitation). Each video is treated like a slot machine "arm":

- Rewards are calculated from user feedback (likes/dislikes and watch percentages).
- Updates occur in real time, allowing the model to quickly adapt to user preferences.

## 📊 Features

- Real-time interaction logging
- API endpoints per algorithm:
  - `/recommend/twoTower/{user_id}`
  - `/recommend/hybrid/{user_id}`
  - `/recommend/bandit/{user_id}`
  - `/interaction` (POST feedback)
  - `/stats` (analytics)
- AI-generated video narratives with automatic labeling
- Text-to-speech conversion for immersive experience

## 🔬 Experimental Results

| Metric                | Hybrid | Two-Tower | Bandit |
| --------------------- | ------ | --------- | ------ |
| Avg Watch %           | 57.0%  | 54.3%     | 53.7%  |
| Avg Like Ratio        | 0.67   | 0.75      | 0.78   |
| Total Interactions    | 140    | 141       | 152    |
| Interactions per User | 35.0   | 35.2      | 38.0   |

**Key Insight**: Sophisticated algorithms may not significantly outperform simpler models in limited-data environments. Content quality and quick feedback loops are often more impactful.

## 📁 Project Structure

```
📦video-recommender/
 ┣ 📂api/ (FastAPI + Recommenders)
 ┣ 📂client/ (React UI)
 ┣ 📂story_generator/ (AI story generation)
```

## 📈 Future Work

- Scale user testing
- Introduce real audio/video features
- Incorporate transformer-based recommenders
- Expand AI content generation to multimodal formats
- Implement long-term A/B testing framework

## 🚀 How to Run

1. **Install dependencies**  
   `pip install -r requirements.txt`

2. **Start Backend**  
   `uvicorn main:app --reload`

3. **Run Frontend**  
   `cd frontend && npm install && npm run dev`

4. **Use API** to test recommendations via `/recommend/{algorithm}/{user_id}`

## 📄 Full Report

For a comprehensive description of the system, implementation, and analysis, [view the full project report](./assets/report.pdf).
